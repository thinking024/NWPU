# 一、概述

## 1.冯.诺依曼计算机的特点

- 由5大部件组成
- 以运算器为中心
- 指令和数据存储在存储器中，可按地址访问
- 指令在存储器内按顺序存放
- 指令、数据都是二进制编码
- 指令=操作码+地址码

## 2.五大部件

- 存储器：存储程序和各种数据，可分为内存和外存
- 运算器：运算处理数据，进行算术运算和逻辑运算
- 控制器：控制计算机各部件进行工作，从内存中取指令、翻译指令、分析指令，然后根据指令的内存向有关部件发送控制命令，控制相关部件执行指令所包含的操作
- 输入设备
- 输出设备

## 3.计算机系统层次结构

1. 微程序设计级
2. 一般机器级
3. 操作系统级
4. 汇编程序级
5. 高级程序级

## 4.计算机性能

- 总线宽度：运算器与存储器相连的内部总线二进制位数

- CPU时钟周期：节拍脉冲
- CPU时钟频率/主频：时钟周期的倒数
- CPI：执行一条指令所需的时钟周期数
- MIPS：每秒执行多少百万条指令



# 二、运算器

计算机算术：二进制原码、反码、补码及相互转换；半加器、全加器结构；补码二进制加减法运算运则推导过程及计算；溢出判断；补码二进制加减法器结构；浮点加减法运算步骤及流程；IEEE754浮点标准；



# 三、存储器

- 存储位元：存放一个二进制代码的最小单元
- 存储单元：若干存储位元组成，存放1个或多个byte的基本单元

## 1.按存取方式分类

- RAM随机存储器：断电后信息丢失
  - DRAM动态读写存储器：需要刷新
  - SRAM静态读写存储器：存取速度快，用于cache
- ROM只读存储器

## 2.cache

局部性原理，由SRAM构成，cache命中则直接使用cache，解决CPU与内存之间速度不匹配

### 2.1cache与主存映射方式

- 直接映射：主存中的块只能装入cache中唯一的位置，**简答，效果不好**
- 全相联映射：主存中的块可以装入cache中任何位置，**复杂，效果最好**
- 组相连映射：直接映射与全相联的一种折中，将cache分组，主存中的块可以装入cache中一组的任意位置
  - 组内全相联映射
  - 组间直接映射

### 2.2cache替换策略

- 随机替换
- FIFO
- LRU
- LFU

### 2.3cache写策略

- 全写法：写入cache同时也写入主存
- 写回法：只单独写cache，cache块被换出时才写回主存
- 写一次法：第一次命中时全写法，后续使用写回法

## 3.虚拟存储器



# 四、指令

## 1.基本概念

- 微命令：控制部件通过控制线向执行部件发出的各种控制命令
- 微操作：执行部件接受命令后完成的操作，也是最小的具有独立意义的操作
- 微指令：在机器的一个CPU周期中，一组可以实现一定操作功能的微命令的组合
- 微程序：一条机器指令的功能是由许多条微指令组成的序列来实现的，而这个序列叫做微程序，微程序是由微指令组成的
- 机器指令：机器周期所对应的指令就称为机器指令
- 指令：计算机进行某种操作的命令
- 程序：计算机执行一个完整任务的指令的集合
- 指令系统：计算机中所有机器指令的集合



## 2.寻址方式

- 指令寻址：寻找下一条要执行的指令地址
  - 顺序寻址
  - 跳跃寻址
- 数据寻址：寻找操作数
  - 隐含寻址
  - 立即寻址：直接给出操作数本身
  - 直接寻址：给出操作数的地址
  - 间接寻址：给出操作数地址的地址
  - 寄存器寻址：给出操作数本身所在的寄存器
  - 寄存器间接寻址：给出操作数的地址所在的寄存器
  - 偏移寻址
    - 相对寻址
    - 基址寻址
    - 变址寻址
  - 堆栈寻址

## 3.指令分类

- 数据传送指令
- 算术运算指令
- 逻辑运算指令
- 程序控制指令
- 输入输出指令
- 字符串处理指令
- 特权指令
- 其他指令

## 4.CISC复杂指令系统

- 指令系统庞大复杂
- 指令长度不固定，指令格式多，寻址方式多
- 各指令差距很大
- 以微程序控制为主

## 5.RISC精简指令系统

- 指令较为精简，复杂指令由简单指令组合实现
- 指令长度固定，指令格式少，寻址方式少
- 采用大量通用寄存器
- 以硬布线控制为主



# 五、CPU

由运算器+控制器组成，控制器功能主要是：取指令、分析指令、执行指令

## 1.控制器

### 1.1.硬布线控制器



### 1.2.微程序控制器

每条机器指令编写成一个微程序，每个微程序包含多个微指令，每个微指令包含多个微操作命令

## 2.主要寄存器

- 运算器中的寄存器
  - 暂存寄存器
  - 累加寄存器
  - 通用寄存器：4个
  - 状态字寄存器
- 控制器中的寄存器
  - 指令寄存器：保存当前正在执行的指令
  - 程序计数器：保存下一条指令的地址
  - 数据地址寄存器：保存CPU所访问数据cache存储器中的地址
  - 数据缓冲寄存器


## 3.指令周期

CPU从主存中取出并执行一条指令的时间

指令周期包含多个机器周期，机器周期又包含多个时钟周期

- 取指周期：从主存中取出指令，放入指令寄存器
- 间址周期：取操作数地址
- 执行周期
- 中断周期：每次指令结束前，发出中断查询信号，监测是否有中断请求

## 4.指令流水线

当第N-2条指令在执行的时候应该对第N-1条指令进行译码，当第N-1条指令在译码时，可以将第N条指令取出来

### 流水线冲突（冒险）

- 资源冲突/结构冒险：多条指令同一时刻争夺同一资源
- 数据冲突/数据冒险：下一条指令会用到当前指令计算出的结果
- 控制冲突/控制冒险：一条指令要确定下一条指令的位置



# 六、总线

## 1.概念

一组能为多个部件**分时共享**的公共信息传送路线

- 共享：总线上可以挂接多个部件，各个部件交换信息都可以通过这组总线
- 分时：某一时刻只允许有一个部件向总线发送信息，多个部件可同时接收信息

## 2.分类

- 片内总线：芯片内部的总线
- 系统总线：计算机各部件之间相互连接的总线
  - 数据总线：双向传输
  - 地址总线：单向传输
  - 控制总线：半双工，传输CPU送出的控制命令和返回给CPU的信号

- I/O总线

## 3.结构

- 单总线：I/O设备、主存可以直接交换信息

- 双总线：主存总线+I/O总线

- 三总线：主存总线+I/O总线+DMA总线

## 4.总线仲裁

解决多个主设备同时竞争总线控制权的问题

- 集中仲裁
  - 链式查询，对电路故障最敏感
  - 计数器定时查询
  - 独立请求方式，速度最快

- 分布仲裁方式

## 5.总线传输

1. 申请分配阶段
2. 寻址阶段
3. 传输阶段
4. 结束阶段

## 6.定时

- 同步定时：采用一个统一的时钟信号来协调，速度快，逻辑简单，可靠性差
- 异步定时：靠双方约定的“请求”+“回答”握手信号实现，，能保证两个速度相差很大的部件进行可靠交换
  - 不互锁
  - 半互锁
  - 全互锁



# I/O设备

## 1.I/O端口编址

- 统一编址/存储器映射：把I/O端口当作存储器单元进行地址分配
- 独立编址/I/O映射：专门的I/O指令来访问I/O端口

## 2.I/O控制方式

- 程序查询方式：需要进行I/O操作时，CPU不断轮询I/O设备状态，若I/O设备未就绪则一直等待

- 中断请求方式：需要进行I/O操作时，CPU通知外设后，继续自己的任务，I/O设备就绪后发出中断请求，CPU在每条指令执行结束前向接口发出中断查询信号，以获取I/O中断请求

  **向量中断**：CPU响应中断时，由硬件直接产生一个向量地址（也称为**中断向量**，指出每个中断设备的中断服务入口）的方式

  具体流程为：

  由中断隐指令（硬件）完成：

  1. 关中断：屏蔽新来的中断
  2. 保存断点：断点压入堆栈
  3. 引出中断服务程序：寻址中断服务程序的入口地址

  由中断服务程序（软件）完成：

  4. 保存现场和屏蔽字
  5. 开中断：允许更高优先级的中断请求，实现中断嵌套
  6. 执行中断服务程序
  7. 关中断
  8. 恢复现场和屏蔽字
  9. 开中断、中断返回

- DMA：外设与内存直接传送数据，无需经过CPU，只需在开始和结束的时候需要CPU参与

  - 停止CPU访存：CPU放弃总线使用权给DMA控制器
  - 周期挪用方式：当I/O接口没有DMA请求时，CPU按程序要求访问内存；一旦I/O接口有DMA请求，则I/O接口挪用一个或几个存取周期
  - 交替内存访问：CPU与DMA控制器交替访问内存。不需要总线使用权的申请、建立和归还过程

- I/O通道



\1. 计算机概要与技术：计算机发展历程，掌握冯诺依曼计算机结构及特点；计算机的三种主要类型及特点；计算机系统层次结构、计算机组成/系统结构/实现等概念的区别；计算机系统性能评价及方法；CPU性能公式；Amdahl定律。

\2. 指令系统：计算机系统的设计基本原理，数据表示、数据类型，指令集及指令格式、寻址方式，指令类型、指令系统设计与优化，CISC与RISC技术的特点及相互关系，RISC基本指令集。

\3. 计算机算术：二进制、十进制、十六进制的转换；二进制原码、反码、补码及移码之间的关系和转换；浮点数的表示与IEEE754浮点标准；定点补码的加减法运算及实现；定点原码/补码的乘除法运算及实现；浮点数的四则运算及实现；定点/浮点运算器的结构。

\4. 处理器：CPU的功能和基本结构；数据通路的功能和基本结构；指令执行过程、控制器的功能和工作原理；单周期数据通路、多周期数据通路、基于状态机的多周期控制方法、基本流水线结构、流水线的三种冒险及相关处理方法、处理器中的意外处理方法；流水线时空图。

\5. 存储层次：SRAM/DRAM结构及基本工作原理，DRAM刷新方法；高速缓存基本原理，高速缓存的相联方式；高速缓存的结构，高速缓存的性能评估与优化；虚拟存储器基本原理，页表结构，TLB。

\6. 总线：总线的组成、分类、特性和性能指标，总线的层次结构，总线定时、传送、仲裁。

\7. 输入/输出：I/O编址的方法，查询、中断、DMA等I/O控制方式的原理及控制机制。